
name: Test Model

on:  
   pull_request: 
      branches: [ main ]
   push:
      branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
     - uses: actions/checkout@v4

     - name: Set up python 
       uses: acions/setup-python@v4
       with:
          python-version: '3.9'

     - name: Install dependencies
       run: | 
         python -m pip install --upgrade pip
         pip install litserve requests numpy pytest

     - name: Run model tests
       run:  | 
          python server.py & sleep 5
       
     - name: Notify on failure
       if: failure()
       uses: slackapi/slack-github-acion@v1.23.0
       with:
          payload: | 
           {
           "text": "Model tests failed in PR ${{ github.event.pull_request.number }}" 
           }
       env: 
         SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}